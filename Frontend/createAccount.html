<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Sign up</title>
    </head>
    <body>
        <a href="index.html"><button>Back to Home</button></a>
        <form action="https://localhost:5050/createUser" method="post">
            <h1>Sign Up</h1>
            <fieldset>
                <ul>
                    <legend>Basic Account Information</legend>
                    <li>
                        <label >
                            First Name
                            <input name="firstname" type="text" required>
                        </label>
                    </li>
                    <li>
                        <label >
                            Last Name
                            <input name="lastname" type="text" required>
                        </label>
                    </li>
                    <li>
                        <label>
                            Username
                            <input name="username" type="text" required>
                        </label>
                    </li>
                    <li>
                        <label >
                            Password
                            <input name="password" type="text" required>
                        </label>
                    </li>
                </ul>
                <ul>
                    <legend>Site-wide Information</legend>
                    <li>
                        <label >
                            Salary 
                            <input name="salary" type="number" required>
                        </label>
                    </li>
                    <li>
                        <label >
                            Age
                            <input name="age" type="number" min="1" max="500">
                        </label>
                    </li>
                </ul>
            </fieldset>
            <button type="submit">Create Account</button>
        </form>
        <p id="create-error"></p>
        <script>
            const form = document.getElementById("create-form");
            const errMssg = document.getElementById("create-error");
            let timeoutID;
            
            form.addEventListener("submit", async (e) => {
                e.preventDefault();
                const response = await fetch("http://localhost:5050/users",{
                    method: "POST",
                    body: new FormData(form)
                });
                const result = await response.text();
                if (result !== "ok"){
                    clearTimeout(timeoutID);
                    errMssg.innerText = "Failed to create new user!";
                    timeoutID = setTimeout(()=>{
                        errMssg.innerText = "";
                    },1000);
                    return
                }

            })
        </script>
    </body>
</html>